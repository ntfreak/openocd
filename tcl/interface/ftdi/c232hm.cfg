# interface/ftdi/c232hm.cfg
#
# FTDI USB Hi-Speed to MPSSE Cable
#
# http://www.ftdichip.com/Products/Cables/USBMPSSE.htm
#
# C232HM-DDHSL-0 and C232HM-EDSL-0 provide 3.3V and 5V on pin 1 (Red),
# respectively.
#
# Adapter: http://www.ftdichip.com/Support/Documents/DataSheets/Cables/DS_C232HM_MPSSE_CABLE.PDF
# Chip: http://www.ftdichip.com/Support/Documents/DataSheets/ICs/DS_FT232H.pdf
# See pinout/colors at end of this file.
# 
# Tech notes:
# http://www.ftdichip.com/Support/Documents/AppNotes/AN_135_MPSSE_Basics.pdf
# http://www.ftdichip.com/Support/Documents/AppNotes/AN_129_FTDI_Hi_Speed_USB_To_JTAG_Example.pdf
#
# This was tested with the 3.3V version adapter (FTDI part number C232HM-DDHSL-0). It should also
# work with the 5V version (C232HM-EDHSL-0), but this has not been tested.
#
# In testing, with adapter_khz at 26000 or 30000 MHz, read speed topped out around 2.2 KiB/s.
# This allowed dumping a 4MB flash chip in about 30 minutes, for example.

interface ftdi
#ftdi_device_desc "C232HM-DDHSL-0"
#ftdi_device_desc "C232HM-EDHSL-0"

# Common PID for FT232H
ftdi_vid_pid 0x0403 0x6014

# Layout
# High data 0xff makes ACBUS (which includes LED on ACBUS6) initially high (off).
# Low data byte 0xf8 makes TRST (AD4) and SRST (AD5) initially high (unasserted).
# High direction 0x40 makes only ACBUS6 output (connected to red LED)
# Low direction 0xfb makes GPIOL0/1 output; used for T/SRST signals below. Only TDO is input (low).
ftdi_layout_init 0xfff8 0x40fb

# Optional Signals (Comment out ftdi_layout_signal line(s) below if board doesn't have T/SRST.)
# ---A*BUS-------CCCCCCCC|DDDDDDDD
# --------\______76543210|76543210
# nTRST 0x0010 = 00000000|00010000 = ADBUS4 (gray)
# nSRST 0x0020 = 00000000|00100000 = ADBUS5 (purple)
# LED	0x4000 = 01000000|00000000 = ACBUS6
ftdi_layout_signal nTRST -data 0x0010 -oe 0x0010
ftdi_layout_signal nSRST -data 0x0020 -oe 0x0020
ftdi_layout_signal LED -data 0x4000 -noe 0x4000

# LED toggle procedures
proc c232hm_LED_on {} {
	ftdi_layout_signal LED -data 0x4000 -oe 0x4000
}

proc c232hm_LED_off {} {
	ftdi_layout_signal LED -data 0x4000 -noe 0x4000
}

# C232HM		FT232H	JTAG
# Num	Color	Name	Func
# 1		Red		VCC		N/A - Do not connect
# 2		Orange	ADBUS0	TCK
# 3		Yellow  ADBUS1	TDI
# 4		Green	ADBUS2	TDO
# 5		Brown   ADBUS3	TMS
# 6		Grey	ADBUS4	(GPIOL0)/nTRST
# 7		Purple	ADBUS5	(GPIOL1)/nSRST
# 8		White   ADBUS6	(GPIOL2) - not used
# 9		Blue	ADBUS7	(GPIOL3) - not used
# 10	Black	GND		Connect to ground

# end interface/ftdi/c232hm.cfg

