# Shikra adapter by Xipiter, based on FT232H

# Pinout: https://www.xipiter.com/uploads/2/4/4/8/24485815/650441.png
# Schematic: https://cdn.shopify.com/s/files/1/0244/5107/products/Screen_Shot_2014-07-28_at_3.52.56_PM_1024x1024.png
# FTDI chip: http://www.ftdichip.com/Support/Documents/DataSheets/ICs/DS_FT232H.pdf

interface ftdi
ftdi_vid_pid 0x0403 0x6014

# Layout as per example by adapter designer at: https://www.xipiter.com/musings/using-the-shikra-to-attack-embedded-systems-getting-started
ftdi_layout_init 0x0c08 0x0f1b

# This section was inspired by: http://openocd.zylin.com/#/c/5307/

# ---A*BUS-------CCCCCCCC|DDDDDDDD
# --------\______76543210|76543210
#GPIOL0	0x0010 = 00000000|00010000 = ADBUS4
#GPIOL1	0x0020 = 00000000|00100000 = ADBUS5
#GPIOL2	0x0040 = 00000000|01000000 = ADBUS6
#GPIOL3	0x0080 = 00000000|10000000 = ADBUS7
#GPIOH0	0x0100 = 00000001|00000000 = ACBUS0
#GPIOH1	0x0200 = 00000010|00000000 = ACBUS1
#GPIOH2	0x0400 = 00000100|00000000 = ACBUS2
#GPIOH3	0x0800 = 00001000|00000000 = ACBUS3
#GPIOH4	0x1000 = 00010000|00000000 = ACBUS4
#GPIOH5	0x2000 = 00100000|00000000 = ACBUS5
#GPIOH6	0x4000 = 01000000|00000000 = ACBUS6
#GPIOH7	0x8000 = 10000000|00000000 = ACBUS7

# TODO Any way to use the LED on this adapter? ACBUS8-9 are out of range of the above 16 bits.

# Available for aliasing as desired
ftdi_layout_signal GPIOL0 -data 0x0010 -oe 0x0010
ftdi_layout_signal GPIOL1 -data 0x0020 -oe 0x0020
ftdi_layout_signal GPIOL2 -data 0x0040 -oe 0x0040
ftdi_layout_signal GPIOL3 -data 0x0080 -oe 0x0080
ftdi_layout_signal GPIOH0 -data 0x0100 -oe 0x0100
ftdi_layout_signal GPIOH1 -data 0x0200 -oe 0x0200
ftdi_layout_signal GPIOH2 -data 0x0400 -oe 0x0400
ftdi_layout_signal GPIOH3 -data 0x0800 -oe 0x0800
ftdi_layout_signal GPIOH4 -data 0x1000 -oe 0x1000
# Note, resistor on ACBUS5, maybe for VBUSDTCT?
ftdi_layout_signal GPIOH5 -data 0x2000 -oe 0x2000
ftdi_layout_signal GPIOH6 -data 0x4000 -oe 0x4000
ftdi_layout_signal GPIOH7 -data 0x8000 -oe 0x8000
