# This is an STM32L073 discovery board with a single STM32L073 chip.
# http://www.st.com/content/st_com/en/products/evaluation-tools/product-evaluation-tools/mcu-eval-tools/stm32-mcu-eval-tools/stm32-mcu-nucleo/nucleo-l073rz.html

source [find interface/stlink-v2-1.cfg]

transport select hla_swd

set WORKAREASIZE 0x2000
# Adapter speeds supported by stlink

# We have to override the default speed set in stm32l0.cfg @ 300kHz to
# the next lower value. The reason is that stlink supports clock
# speeds are ..,480, 240, ... etc. see
# stlink_usb.c::stlink_khz_to_speed_map for details. The same applies
# to the fast speed selection

# Basic speed - available when the target is running from low speed internal oscillator
set ADAPTER_SPEED_BASE 240
# Fast speed - when we switch to HSI16
set ADAPTER_SPEED_FAST 1800

source [find target/stm32l0_dual_bank.cfg]

reset_config srst_only

$_TARGETNAME configure -event gdb-attach {
	echo "Resetting target prior to GDB attach"
        # Without this gdb-attach will fail since the target is running
        reset init
}
